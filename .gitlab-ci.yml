image: ubuntu:18.04

services:
  - mysql:5.7
  - ruby:2.6

variables:
  MYSQL_ROOT_PASSWORD: "knopix"

before_script:
  - ruby -v
  - mysql --version
  - which ruby
  - which mysql
  - gem install bundler --no-document
  - bundle install --jobs $(nproc)  "${FLAGS[@]}"
  - RAILS_ENV=test bundle exec rake db:create db:schema:load

rspec:
  stage: test
  script:
    - bundle exec rspec
